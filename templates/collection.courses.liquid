{% comment %}
  AAI Courses Collection Template
  Professional course catalog with filtering and AAI branding
  Brand colors: Authority Navy (#1e3a5f), Safety Orange (#ff6b35), Electric Blue (#3498db)
{% endcomment %}

{{ 'collection-courses.css' | asset_url | stylesheet_tag }}
{{ 'courses-catalog.js' | asset_url | script_tag }}

<div class="courses-collection-page">
  <!-- Collection Hero Section -->
  {% section 'aai-collection-courses-hero' %}
  
  <!-- Course Filters Section -->
  {% section 'aai-collection-courses-filters' %}
  
  <div class="courses-main-content">
    <div class="container">
      <div class="courses-content-grid">
        <!-- Courses Grid -->
        <div class="courses-grid-container">
          <div class="courses-header">
            <div class="results-info">
              <span id="results-count">{{ collection.products_count }}</span> courses found
            </div>
            
            <div class="view-controls">
              <div class="sort-dropdown">
                <label for="sort-by" class="visually-hidden">Sort by</label>
                <select id="sort-by" class="sort-select">
                  <option value="title-ascending">Course Name (A-Z)</option>
                  <option value="title-descending">Course Name (Z-A)</option>
                  <option value="price-ascending">Price (Low to High)</option>
                  <option value="price-descending">Price (High to Low)</option>
                  <option value="created-descending">Newest First</option>
                </select>
              </div>
              
              <div class="view-toggle">
                <button class="view-btn active" data-view="grid" aria-label="Grid View">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M3 3h8v8H3V3zm10 0h8v8h-8V3zm-10 10h8v8H3v-8zm10 0h8v8h-8v-8z"/>
                  </svg>
                </button>
                <button class="view-btn" data-view="list" aria-label="List View">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M4 6h16v2H4V6zm0 5h16v2H4v-2zm0 5h16v2H4v-2z"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          
          <!-- Courses Grid -->
          <div class="courses-grid" id="courses-grid">
            {% paginate collection.products by 12 %}
              {% for product in collection.products %}
                <div class="course-item" 
                     data-title="{{ product.title | downcase }}"
                     data-level="{{ product.metafields.course.level.value | downcase }}"
                     data-category="{{ product.tags | first | downcase }}"
                     data-ceu="{{ product.metafields.course.ceu_credits.value | default: 0 }}"
                     data-price="{{ product.price }}">
                  {% render 'course-card-professional', product: product %}
                </div>
              {% else %}
                <div class="no-courses">
                  <h3>No courses found</h3>
                  <p>Check back soon for new professional development opportunities.</p>
                </div>
              {% endfor %}
              
              <!-- Pagination -->
              {% if paginate.pages > 1 %}
                <div class="pagination-wrapper">
                  {{ paginate | default_pagination }}
                </div>
              {% endif %}
            {% endpaginate %}
          </div>
          
          <!-- No Results Message -->
          <div id="no-results" class="no-results" style="display: none;">
            <div class="no-results-content">
              <svg class="no-results-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
              </svg>
              <h3>No courses match your criteria</h3>
              <p>Try adjusting your filters or search terms.</p>
              <button class="clear-filters-btn" onclick="clearFilters()">Clear All Filters</button>
            </div>
          </div>
        </div>
        
        <!-- Sidebar -->
        <div class="courses-sidebar">
          <div class="sidebar-widget">
            <h3>Course Levels</h3>
            <div class="level-stats">
              {% assign beginner_count = collection.products | where: 'metafields.course.level.value', 'Beginner' | size %}
              {% assign intermediate_count = collection.products | where: 'metafields.course.level.value', 'Intermediate' | size %}
              {% assign advanced_count = collection.products | where: 'metafields.course.level.value', 'Advanced' | size %}
              {% assign professional_count = collection.products | where: 'metafields.course.level.value', 'Professional' | size %}
              
              <div class="level-stat">
                <span class="level-name">Beginner</span>
                <span class="level-count">{{ beginner_count }}</span>
              </div>
              <div class="level-stat">
                <span class="level-name">Intermediate</span>
                <span class="level-count">{{ intermediate_count }}</span>
              </div>
              <div class="level-stat">
                <span class="level-name">Advanced</span>
                <span class="level-count">{{ advanced_count }}</span>
              </div>
              <div class="level-stat">
                <span class="level-name">Professional</span>
                <span class="level-count">{{ professional_count }}</span>
              </div>
            </div>
          </div>
          
          <div class="sidebar-widget">
            <h3>CEU Credits Available</h3>
            <div class="ceu-stats">
              {% assign total_ceu = 0 %}
              {% for product in collection.products %}
                {% assign ceu = product.metafields.course.ceu_credits.value | default: 0 %}
                {% assign total_ceu = total_ceu | plus: ceu %}
              {% endfor %}
              <div class="total-ceu">
                <span class="ceu-number">{{ total_ceu }}</span>
                <span class="ceu-label">Total CEU Credits</span>
              </div>
            </div>
          </div>
          
          <div class="sidebar-widget">
            <h3>Professional Standards</h3>
            <div class="standards-list">
              <div class="standard-item">
                <svg class="standard-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span>IAAPA Certified</span>
              </div>
              <div class="standard-item">
                <svg class="standard-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span>ASTM F24 Compliant</span>
              </div>
              <div class="standard-item">
                <svg class="standard-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span>NFPA Aligned</span>
              </div>
              <div class="standard-item">
                <svg class="standard-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span>State Approved</span>
              </div>
            </div>
          </div>
          
          <div class="sidebar-widget contact-widget">
            <h3>Need Help?</h3>
            <p>Our education consultants are here to help you choose the right courses for your professional development goals.</p>
            <a href="/pages/contact" class="contact-btn">Contact Us</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Featured Courses Section -->
  {% section 'aai-collection-courses-featured' %}
</div>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "{{ collection.title | escape }}",
  "description": "{{ collection.description | strip_html | escape }}",
  "url": "{{ shop.url }}{{ collection.url }}",
  "provider": {
    "@type": "Organization",
    "name": "AAI Institute",
    "url": "{{ shop.url }}"
  },
  "numberOfItems": {{ collection.products_count }},
  "hasPart": [
    {% for product in collection.products limit: 20 %}
      {
        "@type": "Course",
        "name": "{{ product.title | escape }}",
        "description": "{{ product.description | strip_html | truncate: 160 | escape }}",
        "url": "{{ shop.url }}{{ product.url }}",
        "offers": {
          "@type": "Offer",
          "price": "{{ product.price | money_without_currency }}",
          "priceCurrency": "{{ cart.currency.iso_code }}"
        }
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]
}
</script>

{% schema %}
{
  "name": "Courses Collection Template",
  "class": "courses-collection-template"
}
{% endschema %}
